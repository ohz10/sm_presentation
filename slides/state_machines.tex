\documentclass[aspectratio=169]{beamer}
\usetheme{Madrid}
\usecolortheme{seagull}

\title{State Machines in Rust}
\author{Austin Gilbert}
\begin{document}

\begin{frame}
\begin{center}
\begin{Huge}
State Machines in Rust
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Disclaimers}
\begin{itemize}
\item I am not representing anyone but myself, my views are my own
\item I am not (yet) a Rust expert
\item I am a C++ expert and Programming Languages nerd exploring Rust
\item I am not presenting production code
\item These are contrived examples meant to demonstrate techniques
\end{itemize}
\end{frame}

\begin{frame}{Overview}
\begin{itemize}
\item Tennis Kata
\item Super Simple State Machine
\item Type-State Pattern; Compile-Time State Machines
\item Asynchronous State Machine Parser
\end{itemize}
\end{frame}

\section{Tennis Kata}
\begin{frame}
\begin{center}
\begin{Huge}
Tennis Kata
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{What is a Kata?}
\begin{itemize}
\item A simple problem you solve repeatedly
\item Possibly iterative refactoring, not necessarily
\item Apply different patterns or idioms in each solution
\item Enlighten ourselves about advantages and disadvantages of each technique
\end{itemize}
\end{frame}

\begin{frame}{Tennis Kata}
\begin{block}{Goal}
Model a game of tennis between two players
\end{block}
\begin{block}{Scoring}
\begin{itemize}
\item Love
\item Fifteen
\item Thirty
\item Forty
\item Game
\end{itemize}
\end{block}
\begin{block}{Deuce}
\begin{itemize}
\item players tied with 40 points each
\item then players must win by 2 points
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Tennis Kata}
\begin{center}
\begin{Huge}The Naive Solution\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Tennis Kata: The Naive Solution}
\begin{center}
\begin{Huge}
CODE
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Tennis Kata: The Naive Solution}
\begin{block}{Pros}
\begin{itemize}
\item Small solution
\item Easy to understand
\end{itemize}
\end{block}
\begin{block}{Cons}
\begin{itemize}
\item Doesn't model the infinite nature of a game of tennis
\item No matter what size integer you chose for Score, theoretically, it overflows
\item Memory representation can represent invalid games
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Tennis Kata}
\begin{center}
\begin{Huge}The Naive Solution Refactored\end{Huge}
\linebreak
\begin{Large}
Use Enum for Score
\end{Large}
\end{center}
\end{frame}

\begin{frame}
\begin{center}
\begin{Huge}
CODE
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Tennis Kata: The Naive Solution Refactored}
\begin{block}{Pros}
\begin{itemize}
\item Still pretty simple
\item Eliminates integer overflow in Score
\item Statefulness of tennis game begins to surface
\end{itemize}
\end{block}
\begin{block}{Cons}
\begin{itemize}
\item As presented, we potentially continue play when game should be finished
\item Expands memory footprint; storing who has advantage
\item Logic is more difficult to understand
\item Cyclomatic complexity has risen
\item Forced into making decision about how to handle calling next() when Score is Score::Forty
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Tennis Kata}
\begin{center}
\begin{Huge}4-state State Machine Solution
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Tennis Kata: 4-state State Machine}
\begin{center}
\includegraphics[scale=0.45]{sm4.png}
\end{center}
\end{frame}

\begin{frame}{Tennis Kata: 4-state State Machine}
\begin{center}
\begin{Huge}
CODE
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Tennis Kata: 4-state State Machine}
\begin{block}{Pros}
\begin{itemize}
\item Captures infinite nature of games correctly
\item Easy to understand logic; cyclomatic complexity reduced
\item Only a few states; easy to understand documentation
\item We could add an error state to capture points after game is complete
\item A good example of each state needing different data
\item More memory efficient; only use what we need for each state
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Tennis Kata: 4-state State Machine}
\begin{block}{Cons}
\begin{itemize}
\item We would like the type system to prevent invalid transitions
\item Memory usage for Game not minimized; uses 3 bytes
	\begin{itemize}
	\item 2 bytes Score
	\item 1 byte discriminate
	\end{itemize}
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Tennis Kata}
\begin{Huge}20-state State Machine Solution
\end{Huge}
\end{frame}

\begin{frame}{Tennis Kata: 20-state State Machine}
\includegraphics[scale=0.17]{sm20.png}
\end{frame}

\section{Super Simple State Machine}
\begin{frame}
\begin{center}
\begin{Huge}
Super Simple State Machine
\end{Huge}
\end{center}
\end{frame}

\begin{frame}{Super Simple State Machine}
\includegraphics[scale=0.75]{simple.png}
\begin{block}{Representing...}
\begin{itemize}
\item Using From trait to eliminate invalid transitions
\end{itemize}
\end{block}
\end{frame}

\section{Type-State Pattern}
\begin{frame}
\begin{center}
\begin{Huge}
Type-State Pattern
\end{Huge}
\linebreak
\linebreak
\begin{Large}
Compile-Time State Machines
\end{Large}
\end{center}
\end{frame}

\section{Asynchronous State Machine Parser}
\begin{frame}
\begin{center}
\begin{Large}
Asynchronous State Machine Parser
\end{Large}
\end{center}
\end{frame}

\begin{frame}{Asynchronous State Machine Parser}
\begin{block}{Asynchronous here...}
\emph{nothing} to do with \textbf{async} keyword
\end{block}
\begin{block}{Asynchronous here...} comes from the fact we're parsing a byte at a time making this class of parser suitable for parsing chunked network data coming in \emph{asynchronously}
\end{block}
\end{frame}

\begin{frame}{Asynchronous State Machine Parser}
\begin{itemize}
\item Extremely Simple URL Parser
\item Parse URLs for:
	\begin{itemize}
	\item Protocol: {HTTP, HTTPS}
	\item Path
	\item ASCII-only
	\end{itemize}
\item Ignoring:
	\begin{itemize}
	\item Host and Domain Name
	\item Parameters and Arguments
	\item Authorization
	\item Port Information
	\item UTF-8
	\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Contact}
\begin{center}
\includegraphics[width=1.5in,height=1.5in]{ball_cap.png}
\includegraphics[width=1.5in,height=1.5in]{email_qr.png}
\includegraphics[width=1.5in,height=1.5in]{ohz_10.signal_qr.jpg}
\end{center}
\end{frame}

\end{document}
